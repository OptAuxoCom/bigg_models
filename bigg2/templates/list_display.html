{% extends "parent_display.html" %}
{% block content %}
    <style>
     .centered {
	 text-align: center;
     }
     .results-table {
	 width: 80%;
	 text-align: center;
	 margin-left: auto;
	 margin-right: auto;
	 border-width: 2px;
     }
     .tab-pane {
	 padding: 40px 40px 60px 40px;
     }
    </style>

    <div class="container">
      <div class="col-lg-12">

	<h1 class="centered">Search Results</h1>

	<div class="tabbable" style="margin-bottom:50px;">
	  <ul class="nav nav-tabs">
    	    <li class="active"><a href="#tab_all_results" data-toggle="tab">All Results</a></li>
    	    <li><a href="#tab_models" data-toggle="tab">Models</a></li>
    	    <li><a href="#tab_reactions" data-toggle="tab">Reactions</a></li>
    	    <li><a href="#tab_metabolites" data-toggle="tab">Metabolites</a></li>
    	    <li><a href="#tab_genes" data-toggle="tab">Genes</a></li>
	  </ul>
	  
	  <div class="tab-content">
	    
	    
	    {% for location in ['summary_tab', 'individual_tabs'] %}

	      <!-- Summary tab header -->
	      {% if location == 'summary_tab' %}
		<div class="tab-pane active" id="tab_all_results">
		  {% if not results['models'] and not results['reactions'] and not results['metabolites'] and not results['genes'] %}
		    <h3 class="centered">No results</h3>
		  {% endif %}
	      {% endif %}

	      {% for type in ['models', 'reactions', 'metabolites', 'genes'] %}

		<!-- Individual tab header -->
		{% if location == 'individual_tabs' %}
		  <div class="tab-pane" id="tab_{{type}}">
		    {% if not results[type] %}
		      <h3 class="centered">No {{type}} found</h3>
		    {% endif %}
		{% endif %}

		{% if results[type] %}
		  <h3 class="centered section-label">{{type|capitalize()}}</h3>

		  {% if type == 'models' %}
		    <table class="myTable tablesorter">
		      <thead>
			<tr>
			  <th>BiGG ID</th>
			  <th>Organism</th>
			  <th>Metabolites</th>
			  <th>Reactions</th>
			  <th>Genes</th>
			</tr>
		      </thead>
		      <tbody>
			{% for values in results[type] %}
			  <tr class ='rowlink'>  
			    <td><a href="/models/{{values['bigg_id']}}">{{values['bigg_id']}}</a></td>
			    <td>{{values['organism']}}</td>
			    <td><a href="/models/{{values['bigg_id']}}/metabolites">{{values['metabolite_count']}}</a></td>
			    <td><a href="/models/{{values['bigg_id']}}/reactions">{{values['reaction_count']}}</a></td>
			    <td><a href="/models/{{values['bigg_id']}}/genes">{{values['gene_count']}}</a></td>
			  </tr>
			{% endfor %}
		      </tbody>
		    </table>

		  {% else %}
		    
		    <table class="table table-striped table-bordered results-table">
		      {% for value in results[type] %}
	    		{% if (loop.index - 1) is divisibleby 3 %}
			  <tr>
			{% endif %}

	    		<td style="width: 33.3%; border-width:2px;">
			  {% if value['model_bigg_id'] == 'universal' %}
			    {{value['model_bigg_id']|capitalize()}}
			  {% else %}
			    {{value['model_bigg_id']}}
			  {% endif %}
			  <br/>
			  {% if type == 'metabolites' and 'compartment_bigg_id' in value %}
			    <a href="/models/{{value['model_bigg_id']}}/{{type}}/{{value['bigg_id']}}_{{value['compartment_bigg_id']}}">
			      {{value['bigg_id']}}_{{value['compartment_bigg_id']}}
			    </a>
			  {% else %}
			    <a href="/models/{{value['model_bigg_id']}}/{{type}}/{{value['bigg_id']}}">
			      {{value['bigg_id']}}
			    </a>
			  {% endif %}
			</td>

	    		{% if (loop.index) is divisibleby 3 %}
			  </tr>
			{% endif %}
		      {% endfor %}
		    </table>

		  {% endif %}
		{% endif %}

		<!-- Individual tab footer -->
		{% if location == 'individual_tabs' %}
		  </div>
		{% endif %}
	      {% endfor %}

	      <!-- Summary tab footer -->
	      {% if location == 'summary_tab' %}
		</div>
	      {% endif %}
	    {% endfor %}

	  </div>
	</div>
      </div>
    </div>

  {% endblock %}	
